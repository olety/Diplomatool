{% extends 'generic/header.html' %}
{% load crispy_forms_tags %}

{% block title %}
    Diplomatool - Topics
{% endblock %}

{% block custom_css %}
    .table td {
    text-align: center;
    }

    .table th {
    text-align: center;
    }

    .spacer {
    margin:0;
    padding-top:50px;
    padding-bottom:10px;
    }

    th.sort:before{
    content:"\e150";
    font-family:"Glyphicons Halflings";
    padding-right: 14px;
    }

    th.sort.asc:before {
    content:"\e093";
    }

    th.sort.desc:before {
    content:"\e094";
    }

    #topic-form { display: none; }
{% endblock %}

{% block jumbo %}
    <h1>Topics</h1>
    <div class="spacer">
    {% if user.has_proposed_topic and not user.is_admin %}
        <p>You have already proposed a topic</p>
    {% else %}
        <p>Can't find the perfect one for you? <a class="btn btn-default" href="#" role="button" id="add-topic">Propose
        new</a></p>
    {% endif %}
    </div>
    <div class="panel panel-default">
        <div class="panel-body">
            <table class="table table-hover table-bordered">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Topic</th>
                    <th>Supervisor</th>
                    <th>Description</th>
                    <th>Action</th>
                </tr>
                </thead>
                <tbody>
                {% if topic_list %}
                    {% for topic in topic_list %}
                        <tr>
                            <td>{{ topic.id }}</td>
                            <td>{{ topic.name }}</td>
                            <td>{{ topic.supervisor.first_name }} {{ topic.supervisor.last_name }}</td>
                            <td>{{ topic.short_description }}</td>
                            <td><input class="btn btn-default" type="button" value="Choose"></td>
                        </tr>
                    {% endfor %}
                {% endif %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="col-m-6" id="topic-form" title="Propose a topic">
        {% crispy form form.helper %}
    </div>

{% endblock %}


{% block custom_js %}
    <script>
        $(document).ready(function () {
            var dialog;
            var topicButton = $('#add-topic');
            var cancelButton = $('#button-id-cancel');

            dialog = $("#topic-form").dialog({
                autoOpen: false,
                height: 560,
                width: 500,
                modal: true,
            });

            topicButton.on('click', function (event) {
                topicButton.off("focus");
                dialog.dialog('open');
                event.preventDefault();
            });

            cancelButton.on('click', function (event) {
                dialog.dialog('close');
                event.preventDefault();
            });
        })
    </script>
{% endblock %}